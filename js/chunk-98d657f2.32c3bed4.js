(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-98d657f2"],{"310f":function(t,r,e){"use strict";var a=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("form",{staticClass:"mt-20",on:{submit:function(r){return r.preventDefault(),t.formSubmit.apply(null,arguments)}}},[e("div",{class:["input-group","input-account",{"input-error":t.accountError}]},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.account,expression:"account",modifiers:{trim:!0}}],attrs:{type:"text",id:"account",name:"account"},domProps:{value:t.account},on:{input:function(r){r.target.composing||(t.account=r.target.value.trim())},blur:function(r){return t.$forceUpdate()}}}),e("label",{attrs:{for:"account"}},[t._v("帳號")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.accountError,expression:"accountError"}],staticClass:"error-message"},[t._v(" "+t._s(t.accountErrorMessage)+" ")])]),e("div",{class:["input-group","input-group-last",{"input-error":t.passwordError}]},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"password",id:"password",name:"password"},domProps:{value:t.password},on:{input:function(r){r.target.composing||(t.password=r.target.value.trim())},blur:function(r){return t.$forceUpdate()}}}),e("label",{attrs:{for:"password"}},[t._v("密碼")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.passwordError,expression:"passwordError"}],staticClass:"error-message"},[t._v(" "+t._s(t.passwordErrorMessage)+" ")])]),e("button",{staticClass:"btn btn-primary btn-form-submit mt-40",attrs:{disabled:t.isProcessing}},[t._v(" "+t._s(t.loginButtonText)+" ")]),"/login"===t.fullPath?e("div",{staticClass:"text-right text-underline mt-20"},[e("router-link",{staticClass:"pre-login-link link-separator",attrs:{to:{name:"Register"}}},[t._v("註冊 Alphitter")]),e("router-link",{staticClass:"pre-login-link",attrs:{to:{name:"AdminLogin"}}},[t._v("後台登入")])],1):t._e(),"/admin/login"===t.fullPath?e("div",{staticClass:"text-right text-underline mt-20"},[e("router-link",{staticClass:"pre-login-link",attrs:{to:{name:"Login"}}},[t._v("前台登入")])],1):t._e()])},s=[],n=e("1da1"),o=e("5530"),i=(e("96cf"),e("2f62")),u=e("0dd9"),c=e.n(u),l=e("17db"),p=e("29b2"),m=e("7696"),d={name:"loginForm",data:function(){return{fullPath:"",account:"",password:"",isProcessing:!1,accountError:!1,accountErrorMessage:"",passwordError:!1,passwordErrorMessage:""}},created:function(){var t=this.$route.fullPath;this.fullPath=t},beforeRouteUpdate:function(t,r,e){var a=t.$route.fullPath;this.fullPath=a,e()},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])(["setUser","setToken","setSocket"])),{},{formSubmit:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var e,a,s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(c()(t.account,{min:4,max:50})){r.next=6;break}return t.accountError=!0,t.accountErrorMessage="請輸入帳號",r.abrupt("return");case 6:t.accountError=!1;case 7:if(c()(t.password,{min:4,max:50})){r.next=13;break}return t.passwordError=!0,t.passwordErrorMessage="請輸入密碼",r.abrupt("return");case 13:t.passwordError=!1;case 14:return t.isProcessing=!0,r.prev=15,r.next=18,m["a"].login({account:t.account,password:t.password});case 18:if(e=r.sent,a=e.data,"200"===a.status){r.next=22;break}throw new Error(a.message);case 22:if(!("user"===a.user.role&&"/admin/login"===t.fullPath||"admin"===a.user.role&&"/login"===t.fullPath)){r.next=26;break}return l["a"].fire({title:"帳號不存在"}),t.isProcessing=!1,r.abrupt("return");case 26:return t.setUser(a.user),t.setToken(a.token),r.next=30,Object(p["a"])(a.user);case 30:s=r.sent,t.setSocket(s),"user"===a.user.role&&t.$router.push({name:"Home"}),"admin"===a.user.role&&t.$router.push({name:"Admin"}),r.next=42;break;case 36:r.prev=36,r.t0=r["catch"](15),n=r.t0.response.data,"401"===n.status&&l["a"].fire({title:"帳號不存在"}),"500"===n.status&&l["a"].fire({title:"無法登入，請稍候再試"}),t.isProcessing=!1;case 42:case"end":return r.stop()}}),r,null,[[15,36]])})))()}}),computed:{loginButtonText:function(){return this.isProcessing?"請稍候":"登入"}}},f=d,g=e("2877"),v=Object(g["a"])(f,a,s,!1,null,null,null);r["a"]=v.exports},"335d":function(t,r,e){"use strict";var a=function(){var t=this,r=t.$createElement,a=t._self._c||r;return a("div",{staticClass:"form-header mt-60"},[a("img",{attrs:{src:e("e347"),alt:"logo"}}),a("transition",{attrs:{name:"fade",appear:""}},[a("div",{staticClass:"form-title mt-30"},[t._v(t._s(t._f("title")(t.fullPath)))])])],1)},s=[],n={name:"formHeader",created:function(){var t=this.$route.fullPath;this.fullPath=t},data:function(){return{fullPath:""}},filters:{title:function(t){switch(t){case"/login":return"登入 Alphitter";case"/register":return"建立你的帳號";case"/admin/login":return"後台登入"}}}},o=n,i=e("2877"),u=Object(i["a"])(o,a,s,!1,null,null,null);r["a"]=u.exports},7696:function(t,r,e){"use strict";var a=e("5530"),s=e("0be2");r["a"]={login:function(t){var r=t.account,e=t.password;return s["a"].post("/login",{account:r,password:e})},register:function(t){return s["a"].post("/users",Object(a["a"])({},t))}}},a55b:function(t,r,e){"use strict";e.r(r);var a=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("main",{staticClass:"container-form"},[e("formHeader"),e("transition",{attrs:{name:"translateY",appear:""}},[e("loginForm")],1)],1)},s=[],n=e("335d"),o=e("310f"),i=e("17db"),u={name:"Login",components:{formHeader:n["a"],loginForm:o["a"]},beforeRouteEnter:function(t,r,e){var a=t.params.register;"success"===a&&i["b"].fire({title:"註冊成功"}),e()}},c=u,l=e("2877"),p=Object(l["a"])(c,a,s,!1,null,null,null);r["default"]=p.exports},e347:function(t,r,e){t.exports=e.p+"img/logo.f98e1fbd.svg"}}]);
//# sourceMappingURL=chunk-98d657f2.32c3bed4.js.map