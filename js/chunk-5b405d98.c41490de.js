(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b405d98"],{"0fd7":function(t,e,s){t.exports=s.p+"img/nav-tweet.29c24664.svg"},"1d39":function(t,e,s){t.exports=s.p+"img/nav-chat.055e5ea5.svg"},"223e":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"nav-bottom"},[a("ul",[a("li",[a("router-link",{attrs:{to:{name:"Home"}}},[a("img",{attrs:{src:s("caf5"),alt:"home icon"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"Notification"}}},[a("img",{attrs:{src:s("ba15"),alt:"notification"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"Chat"}}},[a("img",{attrs:{src:s("5def"),alt:"chat"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"DirectMessage"}}},[a("img",{attrs:{src:s("1d39"),alt:"direct message"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"UserAllTweets",params:{userAccount:t.getUser.id}}}},[a("img",{attrs:{src:s("3a00"),alt:"user page icon"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"Settings"}}},[a("img",{attrs:{src:s("3791"),alt:"settings icon"}})])],1),a("li",[a("button",{staticClass:"btn",on:{click:t.logout}},[a("img",{attrs:{src:s("339c"),alt:"logout icon"}})])])]),t.inChat?t._e():a("button",{staticClass:"btn btn-primary btn-round",on:{click:t.openAddNewTweetModal}},[a("img",{attrs:{src:s("0fd7"),alt:"new tweet icon"}})])])},n=[],i=s("5530"),r=s("2f62"),o=s("2708"),c={name:"navBottom",mixins:[o["g"]],props:["inChat"],computed:Object(i["a"])({},Object(r["c"])(["getUser"]))},l=c,m=s("2877"),u=Object(m["a"])(l,a,n,!1,null,null,null);e["a"]=u.exports},"339c":function(t,e,s){t.exports=s.p+"img/nav-logout.48858e52.svg"},3791:function(t,e,s){t.exports=s.p+"img/nav-setting.99ff325c.svg"},"3a00":function(t,e,s){t.exports=s.p+"img/nav-user.2d60ef28.svg"},"5def":function(t,e,s){t.exports=s.p+"img/nav-group-chat.41a12822.svg"},"74ef":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"nav-left"},[a("ul",[a("li",[a("img",{attrs:{src:s("e347"),alt:"logo"},on:{click:t.toHome}})]),a("li",[a("router-link",{attrs:{to:{name:"Home"}}},[a("img",{attrs:{src:s("caf5"),alt:"home"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"Notification"}}},[a("img",{attrs:{src:s("ba15"),alt:"notification"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"Chat"}}},[a("img",{attrs:{src:s("5def"),alt:"chat"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"DirectMessage"}}},[a("img",{attrs:{src:s("1d39"),alt:"direct message"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"UserAllTweets",params:{userAccount:t.getUser.id}}}},[a("img",{attrs:{src:s("3a00"),alt:"user"}})])],1),a("li",[a("router-link",{attrs:{to:{name:"Settings"}}},[a("img",{attrs:{src:s("3791"),alt:"settings"}})])],1),a("li",[a("button",{staticClass:"btn btn-primary btn-round",on:{click:t.openAddNewTweetModal}},[a("img",{attrs:{src:s("0fd7"),alt:"new tweet icon"}})])])]),a("button",{staticClass:"btn btn-left-nav-logout",on:{click:t.logout}},[a("img",{attrs:{src:s("339c"),alt:"logout"}})])])},n=[],i=s("5530"),r=s("2f62"),o=s("2708"),c={name:"navLeft",mixins:[o["g"]],computed:Object(i["a"])({},Object(r["c"])(["getUser"]))},l=c,m=s("2877"),u=Object(m["a"])(l,a,n,!1,null,null,null);e["a"]=u.exports},9348:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-center mt-20"},[s("div",{staticClass:"spinner"},[s("div"),s("div"),s("div"),s("div")])])}],i={name:"spinner"},r=i,o=s("2877"),c=Object(o["a"])(r,a,n,!1,null,null,null);e["a"]=c.exports},"943f":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.titleFromParent?a("div",{class:["nav-top",{"flex-justify-between":t.titleFromParent}]},[t._v(" "+t._s(t.titleFromParent)+" "),"/direct-message"===t.fullPath?a("img",{staticClass:"mr-15 cursor-pointer",attrs:{src:s("d0d8"),alt:""}}):t._e()]):t.userFromParent?a("div",{staticClass:"nav-top"},[a("div",{directives:[{name:"show",rawName:"v-show",value:-1!==t.userFromParent.id,expression:"userFromParent.id !== -1"}],staticClass:"title ml-15"},[a("div",{staticClass:"user-name"},[t._v(t._s(t.userFromParent.name))]),a("div",{staticClass:"tweet-counts"},[t._v(t._s(t._f("userAccount")(t.userFromParent.account)))])])]):a("div",{staticClass:"nav-top"},[t._v(t._s(t._f("title")(t.fullPath)))])},n=[],i=s("2708"),r={name:"navTop",props:["titleFromParent","userFromParent"],mixins:[i["a"]],created:function(){var t=this.$route.fullPath;this.fullPath=t},data:function(){return{fullPath:""}},filters:{title:function(t){switch(t){case"/home":return"首頁";case"/settings":return"帳戶設定";case"/admin/tweets":return"推文清單";case"/admin/users":return"使用者列表";case"/chat":return"聊天室";case"/notification":return"通知"}}}},o=r,c=s("2877"),l=Object(c["a"])(o,a,n,!1,null,null,null);e["a"]=l.exports},a461:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{staticClass:"nav-left"},[a("ul",[a("li",[a("img",{attrs:{src:s("e347"),alt:"logo"},on:{click:t.toHome}})]),a("li",[a("router-link",{attrs:{to:{name:"Home"}}},[a("img",{attrs:{src:s("caf5"),alt:"home"}}),a("span",[t._v("首頁")])])],1),a("li",[a("router-link",{attrs:{to:{name:"Notification"}}},[a("img",{attrs:{src:s("ba15"),alt:"notification"}}),a("span",[t._v("通知")])])],1),a("li",[a("router-link",{attrs:{to:{name:"Chat"}}},[a("img",{attrs:{src:s("5def"),alt:"chat"}}),a("span",[t._v("公開聊天室")])])],1),a("li",[a("router-link",{attrs:{to:{name:"DirectMessage"}}},[a("img",{attrs:{src:s("1d39"),alt:"direct message"}}),a("span",[t._v("私人訊息")])])],1),a("li",[a("router-link",{attrs:{to:{name:"UserAllTweets",params:{userAccount:t.getUser.id}}}},[a("img",{attrs:{src:s("3a00"),alt:"user"}}),a("span",[t._v("個人資料")])])],1),a("li",[a("router-link",{attrs:{to:{name:"Settings"}}},[a("img",{attrs:{src:s("3791"),alt:"settings"}}),a("span",[t._v("設定")])])],1),a("li",[a("button",{staticClass:"btn btn-primary btn-left-nav-new-tweet",on:{click:t.openAddNewTweetModal}},[t._v("推文")])])]),a("button",{staticClass:"btn btn-left-nav-logout",on:{click:t.logout}},[a("img",{attrs:{src:s("339c"),alt:"logout"}}),a("span",[t._v("登出")])])])},n=[],i=s("5530"),r=s("2f62"),o=s("2708"),c={name:"navLeftDesktop",mixins:[o["g"]],computed:Object(i["a"])({},Object(r["c"])(["getUser"]))},l=c,m=s("2877"),u=Object(m["a"])(l,a,n,!1,null,null,null);e["a"]=u.exports},a6d2:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:["chat-message","mb-20",{"flex-justify-end":t.isMyMessage}]},[t.isMyMessage?t._e():s("img",{staticClass:"avatar-img ml-15 mr-10 mb-15",attrs:{src:t.message.Senders.avatar,alt:""}}),s("div",{staticClass:"message-container mr-15"},[s("div",{class:["message",t.isMyMessage?"message-self":"message-other"]},[t._v(" "+t._s(t.message.content)+" ")]),s("div",{class:["timeStamp",{"flex-justify-end":t.isMyMessage}]},[t._v(" "+t._s(t._f("dateToString")(t.message.createdAt))+" ")])])])},n=[],i=(s("fb6a"),{name:"chatMessage",props:["isMyMessage","message"],filters:{dateToString:function(t){if(!t)return"--";var e=new Date,s=new Date(t);return(e.getTime()-s.getTime())/1e3<60?"剛剛":e.toDateString()===s.toDateString()?new Date(t).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"}):new Date(t).toLocaleDateString("zh-TW",{year:"2-digit",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).slice(3)}}}),r=i,o=s("2877"),c=Object(o["a"])(r,a,n,!1,null,null,null);e["a"]=c.exports},ba15:function(t,e,s){t.exports=s.p+"img/nav-notification.56bd22bd.svg"},bf48:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"container"},[t.windowWidth<768?[s("navTop",{attrs:{"title-from-parent":"公開聊天室"}}),s("section",{ref:"containerMessage",staticClass:"container-body container-message"},[s("div",{staticClass:"chat-display"},[t.isProcessing.message?s("spinner"):t.messages.length?t._l(t.messages,(function(e,a){return[e.Senders?s("chatMessage",{key:a,attrs:{isMyMessage:e.Senders.id===t.getUser.id,message:e}}):t._e(),e.onlineHint?s("div",{key:a,staticClass:"user-online-badge mb-15 text-center"},[s("span",[t._v(t._s(e.onlineHint))])]):t._e()]})):s("div",{staticClass:"user-online-badge mb-15 text-center"},[s("span",[t._v("還沒有任何聊天訊息 (ㆆᴗㆆ)")])])],2),s("form",{staticClass:"chat-send",on:{submit:function(e){return e.preventDefault(),t.handleSendMessage.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.message,expression:"message",modifiers:{trim:!0}}],ref:"chatInput",staticClass:"ml-15 mt-10 mb-10",attrs:{type:"text",placeholder:"輸入訊息…"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._m(0)])]),s("navBottom",{attrs:{"in-chat":1}})]:[t.windowWidth>=768&&t.windowWidth<1200?s("navLeft"):s("navLeftDesktop"),s("section",{staticClass:"container-chat"},[s("div",{staticClass:"online-list"},[s("navTop",{attrs:{"title-from-parent":t.getOnlineCounts}}),s("section",{staticClass:"container-body"},[t.isProcessing.user?s("spinner"):t._l(t.users,(function(e){return s("div",{key:e.UserId,staticClass:"chat-user"},[s("img",{staticClass:"avatar-img ml-15 mr-10 mt-10 mb-15",attrs:{src:e.User.avatar,alt:"user avatar"}}),s("div",{staticClass:"chat-user-account"},[s("span",{staticClass:"mr-5"},[t._v(t._s(e.User.name))]),s("span",[t._v(t._s(t._f("userAccount")(e.User.account)))])])])}))],2)],1),s("div",{staticClass:"chat-room"},[s("navTop",{attrs:{"title-from-parent":"公開聊天室"}}),s("section",{ref:"containerMessage",staticClass:"container-body container-message"},[s("div",{staticClass:"chat-display"},[t.isProcessing.message?s("spinner"):t.messages.length?t._l(t.messages,(function(e,a){return[e.Senders?s("chatMessage",{key:a,attrs:{isMyMessage:e.Senders.id===t.getUser.id,message:e}}):t._e(),e.onlineHint?s("div",{key:a,staticClass:"user-online-badge mb-15 text-center"},[s("span",[t._v(t._s(e.onlineHint))])]):t._e()]})):s("div",{staticClass:"user-online-badge mb-15 text-center"},[s("span",[t._v("還沒有任何聊天訊息 (ㆆᴗㆆ)")])])],2),s("form",{staticClass:"chat-send",on:{submit:function(e){return e.preventDefault(),t.handleSendMessage.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.message,expression:"message",modifiers:{trim:!0}}],ref:"chatInput",staticClass:"ml-15 mt-10 mb-10",attrs:{type:"text",placeholder:"輸入訊息…"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._m(1)])])],1)])]],2)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn"},[a("img",{staticClass:"mr-15 ml-15",attrs:{src:s("c0a5"),alt:"send message icon"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"btn"},[a("img",{staticClass:"mr-15 ml-15",attrs:{src:s("c0a5"),alt:"send message icon"}})])}],i=s("5530"),r=s("943f"),o=s("223e"),c=s("a6d2"),l=s("9348"),m=s("74ef"),u=s("a461"),g=s("0dd9"),d=s.n(g),f=s("2f62"),v=s("2708"),p={name:"ChatRoom",mixins:[v["a"]],components:{navTop:r["a"],navBottom:o["a"],spinner:l["a"],chatMessage:c["a"],navLeft:m["a"],navLeftDesktop:u["a"]},data:function(){return{message:"",totalUnread:"",users:[],messages:[],isProcessing:{user:!0,message:!0}}},created:function(){var t=this;this.getSocket.emit("join public"),this.getSocket.on("online list",(function(e){t.isProcessing.user=!0,t.users=e,t.isProcessing.user=!1})),this.getSocket.on("history",(function(e){t.isProcessing.message=!0,t.messages=e,t.isProcessing.message=!1})),this.getSocket.on("connect status",(function(e){t.messages.push({onlineHint:e})})),this.getSocket.on("updated message",(function(e){var s={Senders:{avatar:e.user.avatar,id:e.user.id},content:e.message.content,createdAt:e.message.createdAt,id:e.message.id};t.messages.length?t.messages[t.messages.length-1].id!==e.message.id&&t.messages.push(s):t.messages.push(s)}))},mounted:function(){this.$refs.chatInput.focus()},updated:function(){var t=this;this.$nextTick((function(){t.scrollToMessageBottom()}))},beforeRouteLeave:function(t,e,s){this.getSocket.emit("leave public"),s()},methods:{scrollToMessageBottom:function(){this.$refs.containerMessage.scrollTop=this.$refs.containerMessage.scrollHeight},handleSendMessage:function(){d()(this.message,{min:1})&&(this.getSocket.emit("send message",this.message),this.message="",this.$refs.chatInput.focus(),this.scrollToMessageBottom())},leavePublic:function(){console.log("beforeunload"),this.getSocket.emit("leave public")}},computed:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(f["d"])(["windowWidth"])),Object(f["c"])(["getUser","getSocket"])),{},{getOnlineCounts:function(){var t=this.users.length;return"上線使用者（".concat(t,"）")}})},h=p,b=s("2877"),_=Object(b["a"])(h,a,n,!1,null,null,null);e["default"]=_.exports},c0a5:function(t,e,s){t.exports=s.p+"img/chat-send.fe0c90ed.svg"},caf5:function(t,e,s){t.exports=s.p+"img/nav-home.41da8929.svg"},d0d8:function(t,e,s){t.exports=s.p+"img/chat-dm-selector.47677e03.svg"},e347:function(t,e,s){t.exports=s.p+"img/logo.f98e1fbd.svg"}}]);
//# sourceMappingURL=chunk-5b405d98.c41490de.js.map